---
title: "R Notebook"
output: html_notebook
---

Workforce jobs by region and industry (seasonally adjusted) excel file using Standard Industrial Classigication (SIC) standards

• Jobs
• Hours


```{r}
library(readxl)
library(tidyverse)
library(janitor)
library(lubridate)
library(zoo)
library(dplyr)
library(TableToLongForm)



    
```

```{r}
UK_Labour_Productivity_Jobs_in_Regions_by_Industry %>%
    filter(year_month == max(year_month)) %>%
    group_by(industry) %>% 
    summarise(total_jobs = sum(jobs)) %>% 
    arrange(desc(total_jobs))

```

```{r}
scotland_jobs %>%
    filter(year_month == max(year_month)) %>%
    group_by(industry) %>% 
    summarise(total_jobs = sum(jobs)) %>% 
    arrange(desc(total_jobs))
```

```{r}

UK_output_per_job <- read_xls("raw_data/data/UK_productivity/UK Labour Productivity - Region by Industry.xls", sheet = "OpJ (value)", range = "A7:R27") %>%
    clean_names() %>%
    rename(year = x1) %>%
    mutate(region = "UK") %>% 
    print()



scotland_output_per_job <- read_xls("raw_data/data/UK_productivity/UK Labour Productivity - Region by Industry.xls", sheet = "OpJ (value)", range = "GG7:GW27") %>%
    clean_names()  %>%
    cbind(., UK_output_per_job[1]) %>% 
    mutate(region = "Scotland") %>%
    pivot_longer(cols = -year:-region, names_to = "subsector_letter", values_to = "output_per_job") %>%
    print()


london_output_per_job <- read_xls("raw_data/data/UK_productivity/UK Labour Productivity - Region by Industry.xls", sheet = "OpJ (value)", range = "DQ7:EG27") %>%
    clean_names()  %>%
    cbind(., UK_output_per_job[1]) %>% 
    mutate(region = "London") %>%
    pivot_longer(cols = -year:-region, names_to = "subsector_letter", values_to = "output_per_job") %>%
    print()




```

